# H2 Break and Unbreak

## Tiivistelmät

OWASP Top 10: A01 Broken Access Control

- Virheet käyttöoikeuksien hallinnassa johtavat usein luvattoman tiedon paljastumiseen tai pääsyn suorittamaan toimintoja, joihin käyttäjällä ei ole oikeutta.
- Hallinta tulee toteuttaa palvelinpuolella, jossa hyökkääjä ei voi muokata asetuksia
- Oikeudet tulisi oletusarvoisesti kieltää


Karvinen 2023: Find Hidden Web Directories - Fuzz URLs with ffuf

  - Webbiservereillä on usein piilotettuja hakemistoja, joita voidaan yrittää löytää manuaalisesti kokeilemalla eri vaihtoehtoja ``` /secret, /.svn /admin```
  - Fuffin avulla tämä voidaan tehdä automaattisesti ja säästää valtava määrä aikaa

PortSwigger: Access control vulnerabilities and privilege escalation

- Älä koskaan luota pelkkään "piilottamiseen" oikeuksien hallinnassa
- Käytä mieluiten vain yhtä koko sovelluksen laajuista mekanismia valvonnassa
- Tarkasta ja testaa käyttöoikeudet säännöllisesti

Karvinen 2006: Report Writing (in Finnish)

- Raportti tulee kirjottaa siten, että kuka tahansa samassa ympäristössä oleva pääsee samaan tulokseen
- Vikailmoitukset myös tärkeitä, ellei tärkeimpiä, ne tulee myös raportoida


## a.) Break into 010-staff-only

Tehtävässä käytetty virtuaalikone: <img width="452" height="242" alt="image" src="https://github.com/user-attachments/assets/27f815b0-93f1-4c59-8d53-222ad83fb3d1" />

Kokeillaan ensin syöttää pin kenttään ```'OR+1=1--```
Ja saadaan tulostus "Please enter a number", tästä kokeilin seuraavaksi muuttaa type="number", numeroiden sijaan kirjaimet, ja kenttään uudestaan ```'OR+1=1--```
Tämä onnistui, mutta ei saatu haluttua salasanaa: <img width="1030" height="312" alt="image" src="https://github.com/user-attachments/assets/8c29bb28-fefb-4d24-93a7-717021b6ce9e" />

Katsoin Portswiggeristä apua ja löysin UNION ATTACK, josta ratkaisu saatiin: <img width="503" height="78" alt="image" src="https://github.com/user-attachments/assets/87ca4536-be8e-45f9-b7c0-e4f006418e64" />

<img width="905" height="151" alt="image" src="https://github.com/user-attachments/assets/fcc833fe-7114-4db4-936d-75a1b8012ca2" />

## b.) Fix the 010-staff-only

Tähän kohtaan itsellä loppui täysin keinot kesken, enkä tiennyt mistä aloittaa, joten katsoin vinkin. Muutetaan koodia siten, että käytetään parametrisoituja kyselyitä. Alkuperäinen versio oli altis hyökkäykselle, sillä käyttäjän syöte on suoraan SQL-lauseessa. 

Korjataan koodi: <img width="622" height="146" alt="image" src="https://github.com/user-attachments/assets/566a4dc8-c0cf-4d79-aad7-ae5f4fce5e86" />


  
  
